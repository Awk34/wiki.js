---
title: V04 Плата V04 Board
description: 
published: true
date: 2021-01-04T19:19:20.292Z
tags: 
editor: markdown
dateCreated: 2021-01-02T07:23:03.346Z
---

# V04 Плата V0.4 Board
## Обзор

Плата v0.4 - это тестовая плата, разработанная с целью воспроизведения существующих возможностей плат v0.3, но со следующими усовершенствованиями:

- Более низкая стоимость (главным образом из-за уменьшенного размера, но также и некоторых изменений компонентов)
- Более совместим с готовыми корпусами/корпусами
- Параметр драйвера IAC в шаговом стиле
- Имеет один 40 контактный разъем для всех входов/выходов (за исключением питания 12 В)

> **Примечание:** Версия v0.4 **НЕ** предназначена для замены линейки плат v0.3! 2 разработаны с учетом различных целей. Версия 0.4 предназначена для более тесной интеграции в существующую проводку с целью использования интерфейсных плат для легкого подключения через разъем IDC40. Если вы не понимаете интерфейс на плате v0.4 и не считаете, что это лучший вариант для вашей установки, v0.3 вполне может быть лучшим вариантом для вас.
{.is-warning}


## Board Features

The v0.4 boards includes the following features:

-   4 injector channels
-   4 Ignition outputs
-   Fully protected input channels for CLT, IAT, TPS and O2
-   Optional VR conditioner mount on crank and cam inputs
-   MAP sensor mount location
-   DRV8825 stepper module mount location
-   4 medium-current spare outputs (e.g., fuel pump, thermo fan, boost control, VVT, etc)
-   5 unpopulated/configured optional low-current spare outputs in "proto" section, including tachometer-out
-   A single 40-pin IDC connector includes all pins required for the board with the exception of the 12v input

## Physical Layout

Следует отметить, что существуют некоторые различия между различными версиями платы, однако контакты на основном разъеме IDC40 остаются прежними.

Примечание.Штифты инжектора имеют маркировку 1/2 и 2/2, что позволяет легче и четче прокладывать инжекторы для полукоцепных и пакетных режимов. Если для применения требуется менее 4 инжекторов, просто используйте контакт 1/2 или 2/2. Если применение требует 5 или более инжекторов, рекомендуется использовать как 1/2, так и 2/2, когда это возможно, для более равномерного распределения тока от инициирующих катушек инжектора. Посмотрите[Injector Wiring](/wiring/Injector_wiring) для получения более подробной информации. 

![v0_4_board_annotated_1.jpg](/img/boards/v0_4_board_annotated_1.jpg){.align-left width=50%}


| Pin \# | Function                                 |
| ------ | ---------------------------------------- |
| 1      | Injector 1 - Pin 1/2                     |
| 2      | Injector 2 - Pin 1/2                     |
| 3      | Injector 3 - Pin 1/2                     |
| 4      | Injector 3 - Pin 2/2                     |
| 5      | Injector 4 - Pin 1/2                     |
| 6      | Injector 4 - Pin 2/2                     |
| 7      | Ignition 1                               |
| 8      | Ignition 4                               |
| 9      | Ground                                   |
| 10     | Ground                                   |
| 11     | MAP Sensor (0v-5v)                       |
| 12     | Ground                                   |
| 13     | 5v                                       |
| 14     | Proto Area 1 (0.4.4b+ Flex Sensor)       |
| 15     | Proto Area 2 (0.4.4b+ Fan)               |
| 16     | Proto Area 3 (0.4.4b+ Fuel Pump)         |
| 17     | Proto Area 4 (0.4.4b+ Tachometer)        |
| 18     | Proto Area 5 (0.4.4b+ Clutch)            |
| 19     | Coolant (CLT)                            |
| 20     | Inlet Air Temp (IAT)                     |
| 21     | O2 Sensor                                |
| 22     | TPS input                                |
| 23     | Ground                                   |
| 24     | Cam Input / VR2+                         |
| 25     | Crank Input / VR1+                       |
| 26     | VR2- (Not used for hall sensor)          |
| 27     | VR1- (Not used for hall sensor)          |
| 28     | 5v                                       |
| 29     | Idle Stepper 2B                          |
| 30     | Idle Stepper 2A                          |
| 31     | Idle Stepper 1A                          |
| 32     | Idle Stepper 1B                          |
| 33     | Ignition 3                               |
| 34     | Ignition 2                               |
| 35     | Boost                                    |
| 36     | Idle 2 (For use with 3 wire idle valves) |
| 37     | PWM Idle                                 |
| 38     | VVT                                      |
| 39     | Injector 2 - Pin 2/2                     |
| 40     | Injector 1 - Pin 2/2                     |

## Board Assembly

Сборка полной платы практически идентична v0.3 и остается относительно простой, при этом все компоненты проходят через отверстие и маркируются на плате. Хотя технически не имеет значения, какие компоненты заказа установлены, для простоты рекомендуется следующее:

1. All resistors
2. All diodes (Including LEDS)
3. All capacitors
  > Обратите внимание, что C14 и C16 являются поляризованными конденсаторами, что означает, что они должны быть установлены правильно. Конденсаторы должны иметь знак + с одной стороны. На печатной плате положительная сторона обозначена линией на символе конденсатора.
{.is-warning}

![capacitor_orientation.png](/img/hardware/capacitor_orientation.png){.align-center width=180}

4. All jumper headers (JP\*)
5. Arduino pins:
    * **Suggested method**: Break header pins into required lengths and insert into an Arduino Mega. Place the board over the top of the pins and solder in place
    * Note that not all the pins on the end double row need to be populated (Though there's no harm in doing so). The odd numbered pins (Eg D23, D25 .. DD53) do not need pins on them.
6.  IDC 40 connector
7.  IC sockets
8.  All screw terminals
9.  All MOSFETs
10.  Power regulator
11.  MAP sensor (If used)
  >  **NOTE:** ALL self assembly boards have the MAP sensor with the hole at the top. All assembled boards will typically have the hole on the bottom
{.is-warning}


### Assembly Instruction video

This video is for the v0.3 board, but it largely applies to v0.4 designs as well.

<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/IjKlmIi_Dug" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>

## Board Configuration

The board can be configured in multiple ways depending on the hardware you use and way your setup is configured.

### Board default outputs

Multiple functions within Speeduino have adjustable outputs or can be set to Board Default. The following are the Default pin outs for the v0.4, however all of these functions can be reassigned to other pins if required (Eg to use the onboard high current outputs)

| Function                    | Board output                     | Arduino pin |
|-----------------------------|----------------------------------|-------------|
| Boost control               | IDC Pin 35                       | 7           |
| VVT                         | IDC Pin 38                       | 4           |
| Idle 1                      | IDC Pin 37                       | 5           |
| Idle 2 (3 wire idle valves) | IDC Pin 36                       | 6           |
| Fuel pump                   | Proto area (45) (0.4.4b+ IDC 16) | 45          |
| Fan                         | Proto area (47) (0.4.4b+ IDC 15) | 47          |
| Tacho                       | Proto area (49) (0.4.4b+ IDC 17) | 49          |
| Launch / Clutch             | Proto area (51) (0.4.4b+ IDC 18) | 51          |

### Optional Components

If using a VR crank sensor, the board will require the addition of a VR conditioner. The board has been designed to work with the dual VR conditioner from JBPerf (http://www.jbperf.com/dual_VR/index.html) which will plug directly in. These have been out of stock to purchase directly for some time but can be built from the parts list as the instructions are still available. 

There is also an [official VR board](https://speeduino.com/shop/home/17-dual-vr-conditioner.html) that can be purchased from the speeduino shop which also plugs in directly.

Most partner resellers have their own conditioners with other features such as LEDs for when the signal is triggering high / low. Other 3rd party VR conditioners will also likely work but obviously not all configurations can be validated.


#### SP721 Over-voltage Protection

For users having difficulty obtaining the SP721 used in some versions, see info on the [SP721 Diode Alternate](/wiring/SP721_Diode_Alternate) page

### Jumper Configs

Depending on the type of crank and cam sensors you have, there are a number of jumpers that will need to be set.

Some VR sensors can send high AC voltage into the arduino board. If you are unsure of your sensor type identify it before connecting it to the board. Using a VR sensor with the ‘direct’ pins closed (JP2) and or (JP3) may cause damage to the microprocessor. Danger!

The jumpers that need setting are:

-   JP1 - This sets whether the Ignition outputs are 12v or 5v. Note that even if you set this to 12v you should \*\*NOT\*\* connect these directly to a high current coil. These outputs should only ever go to a logic level coil or an igniter
-   JP2 - Whether or not the RPM1 (Crank) input should be routed via the (Optional) VR conditioner. This should be set to VR when using either a VR sensor or a hall sensor that switches between 0v-12v
-   JP3 - Same as JP2, but for the RPM2 (Cam) input
-   JP4 - 1k pullup resistor for RPM1 input. Should be jumpered ('On') when a sensor is used that switches between ground and floating (Which is most hall effect sensors)
-   JP5 - Same as JP4, but for the RPM2 (Cam) input

To make this simpler, the most common sensor types and their required configurations are below:

| Crank Sensor              | Cam Sensor            | JP2  | JP3  | JP4 | JP5 |
|---------------------------|-----------------------|------|------|-----|-----|
| Hall sensor               | -                     | Hall | Off  | On  | Off |
| VR Sensor                 | -                     | VR   | Off  | Off | Off |
| Hall sensor               | Hall sensor           | Hall | Hall | On  | On  |
| VR Sensor                 | Hall sensor           | VR   | Hall | Off | On  |

### 40-pin connection

You can solder wires directly to the board or use IDC (Insulation Displacement Contact) connectors. The 40-pin IDC is the connector that was used on computer drive ribbon cables for years and old computer cables can be used. A heavier cable, called DuPont cable is recommend for long term use though. Later in the IDE/ATA interfaces life the speed was increased and this required a new fine 80-wire cable. These cables are **NOT** compatible. Some of the pins are connected together causing the magic blue smoke to be released.

## Board revisions

| Version | Changes                                                                                                                                                                                                | BOM                                                                                                        |
|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|
| V0.4.4b | Новая конструкция платы SMD с дополнительными встроенными драйверами и защитными цепями. Он электрически и физически совместим со всеми другими версиями версии 0.4.                   | Not Required                                                                                               |
| V0.4.4  | Модифицирована для упрощения автоматизированной сборки, включая некоторые компоненты SMD и установку датчика давления с плоской стороны вверх. Добавлен переключатель запуска/программы. Только официально продаются как комплектные платы                 | Not Required                                                                                               |
| V0.4.3  |Конденсаторы фильтра добавляются как к первичному, так и к вторичному входам частоты вращения. На вход вторичной частоты вращения добавлен зажим напряжения. Гибкий расход топлива, добавленный к протообласти                                                      | [Download](https://github.com/noisymime/speeduino/raw/master/reference/hardware/v0.4/BOMs/v0.4.3_bom.xlsx) |
| V0.4.2  | Значительное число улучшений маршрутизации. Макет аккуратной протообласти. Зажим напряжения, добавленный к входу первичной частоты вращения                                                                                      | [Download](https://github.com/noisymime/speeduino/raw/master/reference/hardware/v0.4/BOMs/v0.4.2_bom.xlsx) |
| V0.4.1  | Добавлена область Proto. Заменена диодная матрица на SP721. Добавлено дополнительное выходное гнездо высокого тока (J5). Диод перемещен на цепи питания, чтобы предотвратить обратную подачу 5 В USB на рейку 12 В при выключении зажигания | Same as v0.4.2                                                                                             |
| V0.4    | первоначальная версия                                                                                                                                                                                       | [Download](https://github.com/noisymime/speeduino/raw/master/reference/hardware/v0.4/BOMs/v0.4_bom.xlsx)   |

